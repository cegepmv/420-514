<!DOCTYPE html>
<html lang="fr-ca" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/420-514/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=420-514/livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.148.2">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="description" content="Introduction à Express Express est un framework web minimaliste pour Node.js, permettant de créer des applications web robustes et modulaires. Il facilite la gestion des routes, le rendu de vues dynamiques, et l’intégration de middlewares pour diverses tâches comme les sessions ou l’authentification.
Exemple d’Express const express = require(&#34;express&#34;); const app = express(); const port = 3000; app.get(&#34;/&#34;, (req, res) =&gt; { res.send(&#34;Hello World!&#34;); }); app.listen(port, () =&gt; { console.log(`Application à l&#39;écoute sur le port ${port}!`); });">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Express :: Collecte et interprétation de données">
    <meta name="twitter:description" content="Introduction à Express Express est un framework web minimaliste pour Node.js, permettant de créer des applications web robustes et modulaires. Il facilite la gestion des routes, le rendu de vues dynamiques, et l’intégration de middlewares pour diverses tâches comme les sessions ou l’authentification.
Exemple d’Express const express = require(&#34;express&#34;); const app = express(); const port = 3000; app.get(&#34;/&#34;, (req, res) =&gt; { res.send(&#34;Hello World!&#34;); }); app.listen(port, () =&gt; { console.log(`Application à l&#39;écoute sur le port ${port}!`); });">
    <meta property="og:url" content="http://localhost:1313/420-514/nodejsframeworkexpress/express/index.html">
    <meta property="og:site_name" content="Collecte et interprétation de données">
    <meta property="og:title" content="Express :: Collecte et interprétation de données">
    <meta property="og:description" content="Introduction à Express Express est un framework web minimaliste pour Node.js, permettant de créer des applications web robustes et modulaires. Il facilite la gestion des routes, le rendu de vues dynamiques, et l’intégration de middlewares pour diverses tâches comme les sessions ou l’authentification.
Exemple d’Express const express = require(&#34;express&#34;); const app = express(); const port = 3000; app.get(&#34;/&#34;, (req, res) =&gt; { res.send(&#34;Hello World!&#34;); }); app.listen(port, () =&gt; { console.log(`Application à l&#39;écoute sur le port ${port}!`); });">
    <meta property="og:locale" content="fr_ca">
    <meta property="og:type" content="article">
    <meta property="article:section" content="Cadriciel (framework) côté serveur : Node.js / express">
    <meta itemprop="name" content="Express :: Collecte et interprétation de données">
    <meta itemprop="description" content="Introduction à Express Express est un framework web minimaliste pour Node.js, permettant de créer des applications web robustes et modulaires. Il facilite la gestion des routes, le rendu de vues dynamiques, et l’intégration de middlewares pour diverses tâches comme les sessions ou l’authentification.
Exemple d’Express const express = require(&#34;express&#34;); const app = express(); const port = 3000; app.get(&#34;/&#34;, (req, res) =&gt; { res.send(&#34;Hello World!&#34;); }); app.listen(port, () =&gt; { console.log(`Application à l&#39;écoute sur le port ${port}!`); });">
    <meta itemprop="wordCount" content="1650">
    <title>Express :: Collecte et interprétation de données</title><link rel="icon" href="/420-123/images/favicon.png" type="image/png">
    <link href="/420-514/css/auto-complete/auto-complete.min.css?1756297722" rel="stylesheet">
    <script src="/420-514/js/auto-complete/auto-complete.min.js?1756297722" defer></script>
    <script src="/420-514/js/search-lunr.js?1756297722" defer></script>
    <script src="/420-514/js/search.js?1756297722" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/420-514/searchindex.en.js?1756297722";
    </script>
    <script src="/420-514/js/lunr/lunr.min.js?1756297722" defer></script>
    <script src="/420-514/js/lunr/lunr.stemmer.support.min.js?1756297722" defer></script>
    <script src="/420-514/js/lunr/lunr.multi.min.js?1756297722" defer></script>
    <script src="/420-514/js/lunr/lunr.fr.min.js?1756297722" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['fr'];
    </script>
    <link href="/420-514/fonts/fontawesome/css/fontawesome-all.min.css?1756297722" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/420-514/fonts/fontawesome/css/fontawesome-all.min.css?1756297722" rel="stylesheet"></noscript>
    <link href="/420-514/css/perfect-scrollbar/perfect-scrollbar.min.css?1756297722" rel="stylesheet">
    <link href="/420-514/css/theme.css?1756297722" rel="stylesheet">
    <link href="/420-514/css/format-html.css?1756297722" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/nodejsframeworkexpress\/express\/index.html';
      window.relearn.relBasePath='..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313\/420-514';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=true;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'green' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
  </head>
  <body class="mobile-support html" data-url="/420-514/nodejsframeworkexpress/express/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/420-514/index.html"><span itemprop="name">Collecte et interprétation de données</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/420-514/nodejsframeworkexpress/index.html"><span itemprop="name">Cadriciel (framework) côté serveur : Node.js / express</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Express</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable nodejsframeworkexpress" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="express">Express</h1>

<h2 id="introduction-à-express">Introduction à Express</h2>
<p><strong>Express</strong> est un framework web minimaliste pour Node.js, permettant de créer des applications web robustes et modulaires. Il facilite la gestion des routes, le rendu de vues dynamiques, et l&rsquo;intégration de middlewares pour diverses tâches comme les sessions ou l&rsquo;authentification.</p>
<h3 id="exemple-dexpress">Exemple d&rsquo;Express</h3>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#34;Hello World!&#34;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Application à l&#39;écoute sur le port </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!`</span>);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<p><a href="#R-image-18c6f66d50ba70b6a15931ed5244c0c6" class="lightbox-link"><img alt="Exepmle simple de Serveur Node" class="lazy lightbox figure-image" loading="lazy" src="/420-514/images/simpleNodeServer.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-18c6f66d50ba70b6a15931ed5244c0c6"><img alt="Exepmle simple de Serveur Node" class="lazy lightbox lightbox-image" loading="lazy" src="/420-514/images/simpleNodeServer.png"></a></p>
<p>Source : <a href="https://app.pluralsight.com/library/courses/nodejs-express-foundations/description" rel="external" target="_blank">https://app.pluralsight.com/library/courses/nodejs-express-foundations/description</a></p>
<h2 id="middleware-et-gestion-des-erreurs">Middleware et Gestion des Erreurs</h2>
<p>Les middlewares sont des fonctions intermédiaires dans le traitement des requêtes. Ils sont essentiels pour gérer les fichiers statiques, les sessions, les erreurs, etc.</p>
<p><a href="#R-image-a50f077e72cea6a5f920c94280f31844" class="lightbox-link"><img alt="Middleware" class="lazy lightbox figure-image" loading="lazy" src="/420-514/images/Middleware.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-a50f077e72cea6a5f920c94280f31844"><img alt="Middleware" class="lazy lightbox lightbox-image" loading="lazy" src="/420-514/images/Middleware.png"></a></p>
<p>Source : <a href="https://app.pluralsight.com/library/courses/nodejs-express-foundations/description" rel="external" target="_blank">https://app.pluralsight.com/library/courses/nodejs-express-foundations/description</a></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">let</span> <span style="color:#a6e22e">middlewareFunction</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Logique du middleware
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">middlewareFunction</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#ae81ff">3000</span>);</span></span></code></pre></div>
<p>Un <strong>middleware</strong> dans Node.js est une fonction qui a accès à l&rsquo;objet de requête (<code>req</code>), l&rsquo;objet de réponse (<code>res</code>), et à la fonction <code>next()</code> dans le cycle de traitement des requêtes HTTP.</p>
<p>Les middlewares permettent de modifier, d&rsquo;analyser, d&rsquo;intercepter ou de répondre aux requêtes avant qu&rsquo;elles n&rsquo;atteignent les routes finales. Ils sont très utiles pour ajouter des fonctionnalités transversales (comme l&rsquo;authentification, la gestion des erreurs, le logging, etc.) sans modifier chaque route de l&rsquo;application.</p>
<h3 id="fonctionnement-dun-middleware-">Fonctionnement d&rsquo;un middleware :</h3>
<p>Un middleware est une fonction qui peut faire les choses suivantes :</p>
<ol>
<li><strong>Exécuter du code</strong>.</li>
<li><strong>Modifier l&rsquo;objet de requête (<code>req</code>) ou de réponse (<code>res</code>)</strong>.</li>
<li><strong>Terminer le cycle de la requête/réponse</strong> (par exemple en renvoyant une réponse au client).</li>
<li><strong>Appeler la fonction <code>next()</code></strong> pour passer la main au middleware suivant dans la chaîne.</li>
</ol>
<h3 id="exemple-de-middleware-simple-">Exemple de middleware simple :</h3>
<p>Voici un exemple basique d&rsquo;un middleware dans Express :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Middleware exécuté pour chaque requête&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>(); <span style="color:#75715e">// Passe la main au middleware ou à la route suivante
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>});</span></span></code></pre></div>
<p>Dans cet exemple :</p>
<ul>
<li>Ce middleware s&rsquo;exécutera pour <strong>toutes les requêtes</strong> reçues par l&rsquo;application.</li>
<li>Il affiche un message dans la console et appelle <code>next()</code> pour permettre à Express de continuer avec les middlewares suivants ou les routes définies.</li>
</ul>
<h3 id="types-de-middlewares-dans-express-">Types de middlewares dans Express :</h3>
<ol>
<li>
<p><strong>Middlewares d&rsquo;application</strong> :</p>
<ul>
<li>
<p>Ces middlewares sont associés à l&rsquo;instance de l&rsquo;application (<code>app</code>) et s&rsquo;exécutent pour toutes les routes ou pour des routes spécifiques.</p>
</li>
<li>
<p>Exemple :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Ceci est un middleware d\\&#39;</span><span style="color:#a6e22e">application</span><span style="color:#960050;background-color:#1e0010">&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>Middlewares spécifiques à une route</strong> :</p>
<ul>
<li>
<p>Ils s&rsquo;appliquent à une ou plusieurs routes spécifiques.</p>
</li>
<li>
<p>Exemple :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/user&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#39;Middleware pour la route /user&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>}, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;Profil utilisateur&#39;</span>);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>Middlewares intégrés</strong> :</p>
<ul>
<li>
<p>Express fournit des middlewares intégrés comme <code>express.json()</code> ou <code>express.urlencoded()</code> pour parser les corps des requêtes.</p>
</li>
<li>
<p>Exemple :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#a6e22e">json</span>());</span></span></code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>Middlewares tiers</strong> :</p>
<ul>
<li>
<p>Vous pouvez installer des middlewares fournis par la communauté pour des tâches spécifiques, comme la gestion des sessions, la sécurité, etc.</p>
</li>
<li>
<p>Exemple : <code>morgan</code> pour le logging des requêtes HTTP.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">morgan</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;morgan&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">morgan</span>(<span style="color:#e6db74">&#39;dev&#39;</span>));</span></span></code></pre></div>
</li>
</ul>
</li>
<li>
<p><strong>Middlewares de gestion des erreurs</strong> :</p>
<ul>
<li>
<p>Un middleware de gestion des erreurs prend quatre paramètres : <code>(err, req, res, next)</code> et est utilisé pour capturer les erreurs et renvoyer des réponses appropriées.</p>
</li>
<li>
<p>Exemple :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">500</span>).<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;Quelque chose s\&#39;est mal passé !&#39;</span>);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
</li>
</ul>
</li>
</ol>
<h2 id="pourquoi-utiliser-des-middlewares-">Pourquoi utiliser des middlewares ?</h2>
<ol>
<li><strong>Modularité</strong> : Ils permettent d&rsquo;ajouter des fonctionnalités réutilisables, comme la gestion des sessions, sans toucher à chaque route de l&rsquo;application.</li>
<li><strong>Composabilité</strong> : Les middlewares peuvent être chaînés pour créer un pipeline de traitement des requêtes.</li>
<li><strong>Réutilisabilité</strong> : Vous pouvez créer des middlewares personnalisés qui peuvent être réutilisés à travers plusieurs routes ou applications.</li>
</ol>
<h2 id="utilisation-des-bases-de-données">Utilisation des Bases de Données</h2>
<p>Node.js prend en charge plusieurs bases de données comme MongoDB. Pour connecter votre application à une base de données, vous devez installer le pilote correspondant.</p>
<p><strong>Exemple MongoDB :</strong></p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">MongoClient</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;mongodb&#34;</span>).<span style="color:#a6e22e">MongoClient</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">MongoClient</span>.<span style="color:#a6e22e">connect</span>(<span style="color:#e6db74">&#34;mongodb://localhost:27017/animals&#34;</span>, (<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">client</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) <span style="color:#66d9ef">throw</span> <span style="color:#a6e22e">err</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">db</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">db</span>(<span style="color:#e6db74">&#34;animals&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">db</span>.<span style="color:#a6e22e">collection</span>(<span style="color:#e6db74">&#34;mammals&#34;</span>).<span style="color:#a6e22e">find</span>().<span style="color:#a6e22e">toArray</span>((<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">result</span>) =&gt; {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">err</span>) <span style="color:#66d9ef">throw</span> <span style="color:#a6e22e">err</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">result</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">close</span>();
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<h2 id="gestion-du-logging">Gestion du logging</h2>
<p>Autre middlewares pour la gestion du logging, ainsi que pour servir des fichiers statiques comme des pages HTML avec Express.</p>
<h3 id="ajouter-des-middlewares-pour-le-logging">Ajouter des Middlewares pour le Logging</h3>
<p>Les middlewares sont des fonctions qui ont accès à l&rsquo;objet <code>request</code> (req), l&rsquo;objet <code>response</code> (res) et à la fonction <code>next</code> dans le cycle de requête-réponse. Ils sont utiles pour intercepter et gérer des requêtes avant qu&rsquo;elles ne parviennent aux routes définies.</p>
<h3 id="ajouter-un-middleware-de-logging">Ajouter un Middleware de Logging</h3>
<p>Un middleware de logging peut enregistrer chaque requête reçue par le serveur. Ajoutez le code suivant au début de votre fichier <code>index.js</code> :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Middleware de logging
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">method</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<h3 id="servir-des-fichiers-statiques">Servir des Fichiers Statiques</h3>
<p>Pour servir des fichiers statiques comme des pages HTML, CSS, ou des images, Express offre une méthode simple. Créez un dossier <code>public</code> dans votre projet pour stocker ces fichiers.</p>
<h4 id="créer-un-dossier-public">Créer un Dossier <code>public</code></h4>
<ol>
<li>
<p><strong>Créez le dossier <code>public</code></strong> à la racine de votre projet :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir public</span></span></code></pre></div>
</li>
<li>
<p><strong>Ajoutez un fichier HTML dans le dossier <code>public</code></strong> :</p>
<p>Créez un fichier <code>index.html</code> dans le dossier <code>public</code> avec le contenu suivant :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!DOCTYPE html&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;fr&#34;</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;UTF-8&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1.0&#34;</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">title</span>&gt;Page d&#39;accueil&lt;/<span style="color:#f92672">title</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">head</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">h1</span>&gt;Bienvenue sur mon site!&lt;/<span style="color:#f92672">h1</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">p</span>&gt;Ceci est une page HTML servie par Express.&lt;/<span style="color:#f92672">p</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">body</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">html</span>&gt;</span></span></code></pre></div>
</li>
</ol>
<h4 id="configurer-express-pour-servir-les-fichiers-statiques">Configurer Express pour Servir les Fichiers Statiques</h4>
<p>Ajoutez le code suivant à votre <code>index.js</code> pour permettre à Express de servir les fichiers du dossier <code>public</code> :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#75715e">// Servir des fichiers statiques
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#66d9ef">static</span>(<span style="color:#e6db74">&#39;public&#39;</span>));</span></span></code></pre></div>
<h4 id="tester">Tester</h4>
<ol>
<li>
<p><strong>Testez le Middleware de Logging</strong> : Lancez votre serveur avec <code>node index.js</code> et accédez à différentes routes (par exemple, <code>/</code> ou <code>/info</code>). Vous devriez voir les requêtes enregistrées dans le terminal.</p>
</li>
<li>
<p><strong>Testez le Middleware de Gestion des Erreurs</strong> : Pour simuler une erreur, vous pouvez créer une route qui lève une exception :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/cause-error&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Erreur simulée!&#39;</span>);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<p>En accédant à cette route (<code>GET &lt;http://localhost:3000/cause-error</code>&gt;), vous verrez le message d&rsquo;erreur personnalisé.</p>
</li>
<li>
<p><strong>Testez la Servitude des Fichiers Statiques</strong> : Accédez à <code>http://localhost:3000/</code> dans votre navigateur. Vous devriez voir la page HTML créée dans <code>public/index.html</code>.</p>
</li>
</ol>
<h4 id="le-fichier-indexjs">Le Fichier <code>index.js</code></h4>
<p>Voici le code final du fichier <code>index.js</code> :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;express&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">port</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">3000</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Middleware de logging
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">method</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>();
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Servir des fichiers statiques
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#66d9ef">static</span>(<span style="color:#e6db74">&#39;public&#39;</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Route de base
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;Bienvenue sur mon serveur Express!&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Route pour afficher un message personnalisé
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/hello/:name&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">name</span>;
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">`Bonjour, </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">name</span><span style="color:#e6db74">}</span><span style="color:#e6db74">!`</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Route qui renvoie les informations sur le serveur
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/info&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">version</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;1.0.0&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">description</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Ceci est un serveur simple utilisant Express.js&#39;</span>,
</span></span><span style="display:flex;"><span>  });
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Route pour simuler une erreur
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/cause-error&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">&#39;Erreur simulée!&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Middleware de gestion des erreurs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>((<span style="color:#a6e22e">err</span>, <span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>, <span style="color:#a6e22e">next</span>) =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">stack</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">status</span>(<span style="color:#ae81ff">500</span>).<span style="color:#a6e22e">send</span>(<span style="color:#e6db74">&#39;Quelque chose s\&#39;est mal passé!&#39;</span>);
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Démarrer le serveur
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#a6e22e">port</span>, () =&gt; {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#e6db74">`Serveur en écoute sur &lt;http://localhost&gt;:</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">port</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>);
</span></span><span style="display:flex;"><span>});</span></span></code></pre></div>
<hr>
<h2 id="utiliser-la-librairie-de-journalisation-winston">Utiliser la librairie de Journalisation <code>Winston</code></h2>
<p>Winston est une bibliothèque de journalisation (logging) populaire pour Node.js. Elle permet aux développeurs de capturer, formater, et gérer des logs dans différentes sorties (fichiers, console, bases de données, etc.). Winston est flexible et extensible, ce qui en fait un choix idéal pour les projets nécessitant une gestion fine des logs, notamment pour le débogage, la surveillance et le suivi des événements.</p>
<h3 id="principales-fonctionnalités-de-winston">Principales Fonctionnalités de Winston</h3>
<ul>
<li><strong>Multiples Transports</strong> : Winston peut envoyer des logs vers différents supports appelés &ldquo;transports&rdquo; (fichiers, bases de données, systèmes de journalisation distants, etc.).</li>
<li><strong>Niveaux de Log</strong> : Il prend en charge différents niveaux de log (ex: error, warn, info, debug) pour filtrer et gérer les logs en fonction de leur importance.</li>
</ul>
<p><a href="#R-image-ad68aadef844323d9415f81a8bb1714f" class="lightbox-link"><img alt="Source : https://app.pluralsight.com/library/courses/nodejs-express-foundations/description" class="lazy lightbox figure-image" loading="lazy" src="/420-514/images/Winston.png" style=" height: auto; width: auto;"></a>
<a href="javascript:history.back();" class="lightbox-back" id="R-image-ad68aadef844323d9415f81a8bb1714f"><img alt="Source : https://app.pluralsight.com/library/courses/nodejs-express-foundations/description" class="lazy lightbox lightbox-image" loading="lazy" src="/420-514/images/Winston.png"></a></p>
<p>Source : <a href="https://app.pluralsight.com/library/courses/nodejs-express-foundations/description" rel="external" target="_blank">app.pluralsight.com/</a></p>
<ul>
<li><strong>Formats de Log</strong> : Winston permet de formater les messages de log en JSON, en texte, ou en tout autre format personnalisé.</li>
<li><strong>Configuration Flexible</strong> : Il est possible de configurer plusieurs loggers, chacun avec ses propres niveaux de log, formats et transports.</li>
</ul>
<h3 id="installation-de-winston">Installation de Winston</h3>
<p>Pour installer Winston dans votre projet Node.js, utilisez la commande suivante :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>npm install winston</span></span></code></pre></div>
<h3 id="exemple-dutilisation-de-winston">Exemple d&rsquo;Utilisation de Winston</h3>
<p>Voici un exemple simple d&rsquo;utilisation de Winston pour configurer un logger qui envoie les logs à la console et à un fichier.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">winston</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#39;winston&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Configuration du logger
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">logger</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">createLogger</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Le niveau minimum de log est défini à info. 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Cela signifie que tous les logs de niveau info et plus élevés (ex: warn, error) seront capturés.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">level</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;info&#39;</span>, <span style="color:#75715e">// Niveau minimum de log (info, warn, error, etc.)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#75715e">// Les logs sont formatés en JSON et incluent un timestamp pour chaque message.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">combine</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">timestamp</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">json</span>() <span style="color:#75715e">// Format des logs en JSON
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ),
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// Le logger est configuré avec deux transports : la console et un fichier app.log
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">transports</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">transports</span>.<span style="color:#a6e22e">Console</span>(), <span style="color:#75715e">// Log vers la console
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">winston</span>.<span style="color:#a6e22e">transports</span>.<span style="color:#a6e22e">File</span>({ <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;logs/app.log&#39;</span> }) <span style="color:#75715e">// Log vers un fichier
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  ]
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Exemple de logs
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">&#39;L\&#39;application a démarré&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#39;Attention, ceci est un avertissement&#39;</span>);
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Une erreur est survenue&#39;</span>);</span></span></code></pre></div>
<p>Exemple du code complet :</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-jsx" data-lang="jsx"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">express</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;express&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">join</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;node:path&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">createLogger</span>, <span style="color:#a6e22e">format</span>, <span style="color:#a6e22e">transports</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;winston&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">logger</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createLogger</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">level</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;info&#39;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">format</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">combine</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">timestamp</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">format</span>.<span style="color:#a6e22e">json</span>()
</span></span><span style="display:flex;"><span>  ),
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">transports</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">transports</span>.<span style="color:#a6e22e">Console</span>(),
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">transports</span>.<span style="color:#a6e22e">File</span>({ <span style="color:#a6e22e">filename</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;logs/app.log&#39;</span> })
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">logAll</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">request</span>, <span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">next</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">info</span>(<span style="color:#e6db74">`L&#39;application a démarré : </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">url</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">warn</span>(<span style="color:#e6db74">&#39;Attention, ceci est un avertissement&#39;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">logger</span>.<span style="color:#a6e22e">error</span>(<span style="color:#e6db74">&#39;Une erreur est survenue&#39;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">next</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#a6e22e">json</span>())
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">express</span>.<span style="color:#66d9ef">static</span>(<span style="color:#a6e22e">join</span>(<span style="color:#a6e22e">process</span>.<span style="color:#a6e22e">cwd</span>(), <span style="color:#e6db74">&#39;src&#39;</span>, <span style="color:#e6db74">&#39;public&#39;</span>)))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">logAll</span>)</span></span></code></pre></div>
<h3 id="utilisations-">Utilisations :</h3>
<ol>
<li><strong>Débogage</strong> : Winston est souvent utilisé pour capturer des erreurs et des messages de débogage pendant le développement.</li>
<li><strong>Surveillance en Production</strong> : En production, Winston permet de centraliser les logs pour surveiller le bon fonctionnement de l&rsquo;application et diagnostiquer les problèmes.</li>
<li><strong>Audit et Traçabilité</strong> : Winston peut être configuré pour capturer des logs spécifiques pour l&rsquo;audit, la sécurité ou la traçabilité des événements critiques.</li>
</ol>
<hr>
<h2 id="liens-utiles-">Liens utiles :</h2>
<p>Formation : <a href="https://app.pluralsight.com/library/courses/nodejs-express-foundations/description" rel="external" target="_blank">https://app.pluralsight.com/library/courses/nodejs-express-foundations</a></p>
<p>Article : <a href="https://betterstack.com/community/guides/logging/how-to-install-setup-and-use-winston-and-morgan-to-log-node-js-applications/" rel="external" target="_blank">Guide Winston</a></p>
<p>Documentation : <a href="https://github.com/winstonjs/winston" rel="external" target="_blank">Github Winston</a></p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
          <a id="R-logo" class="R-default" href="/420-514/index.html">
            <div class="logo-title">Collecte et interprétation de données</div>
          </a>
        </div>
        <search><form action="/420-514/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/420-514/intro/index.html"><a class="padding" href="/420-514/intro/index.html">1. Préalables</a><ul id="R-subsections-58f2a84c91d5deefe8bdd3a21213404a" class="collapsible-menu"></ul></li>
            <li class="parent " data-nav-id="/420-514/nodejsframeworkexpress/index.html"><a class="padding" href="/420-514/nodejsframeworkexpress/index.html">2. Cadriciel (framework) côté serveur : Node.js / express</a><ul id="R-subsections-0ef22c48ddd9f1f383c22c15e8abd43a" class="collapsible-menu">
            <li class="" data-nav-id="/420-514/nodejsframeworkexpress/nodejs/index.html"><a class="padding" href="/420-514/nodejsframeworkexpress/nodejs/index.html">NodeJs</a></li>
            <li class="active " data-nav-id="/420-514/nodejsframeworkexpress/express/index.html"><a class="padding" href="/420-514/nodejsframeworkexpress/express/index.html">Express</a></li>
            <li class="" data-nav-id="/420-514/nodejsframeworkexpress/lab/index.html"><a class="padding" href="/420-514/nodejsframeworkexpress/lab/index.html">Laboratoire : Commencer avec Node.js et Express.js</a></li>
            <li class="" data-nav-id="/420-514/nodejsframeworkexpress/lab2/index.html"><a class="padding" href="/420-514/nodejsframeworkexpress/lab2/index.html">Laboratoire : Gestion des Erreurs et Logging</a></li></ul></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
          </ul>
        </div>
<div id="R-footer"><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">
  <div class="logo-title">Sara Boumehraz</div>
  <br/>
  <img alt="Licence Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/80x15.png" />
</a>
<br>Creative Commons BY-NC-SA</br></div>
      </div>
    </aside>
    <script src="/420-514/js/clipboard/clipboard.min.js?1756297722" defer></script>
    <script src="/420-514/js/perfect-scrollbar/perfect-scrollbar.min.js?1756297722" defer></script>
    <script src="/420-514/js/theme.js?1756297722" defer></script>
  </body>
</html>
