+++
draft = false
title = 'üìò S√©curit√© des API'
weight = 51
+++


## Pourquoi s√©curiser les API ?

Une API est comme une **porte d‚Äôentr√©e** vers ton syst√®me.
Sans s√©curit√© :

* un attaquant peut acc√©der aux donn√©es sensibles (ex. : infos personnelles, num√©ros de carte de cr√©dit),
* modifier des donn√©es (changer le prix d‚Äôun produit dans une boutique),
* ou bloquer ton service avec une attaque DDoS.

**Exemple concret** :
Une API de streaming vid√©o sans authentification ‚ûù n‚Äôimporte qui peut t√©l√©charger gratuitement le contenu en envoyant des requ√™tes HTTP.

### Endpoints API

* Un endpoint est l‚ÄôURL d‚Äôacc√®s √† une ressource.
* Ils repr√©sentent une **surface d‚Äôattaque critique** : ex. `/api/users/:id`.
* Bonne pratique : v√©rifier les autorisations sur chaque endpoint et ne jamais exposer d‚Äôinfos sensibles inutilement.

## **Types d‚ÄôAPI et diff√©rences**

* **API B2C** : expos√©es aux clients finaux (apps mobiles/web).
* **API B2B** : √©changes entre entreprises (banque, facturation).
* **API publiques** : ouvertes √† tous, n√©cessitent une doc claire et des limites strictes.
* **API priv√©es/internes** : utilis√©es en interne, mais restent vuln√©rables si expos√©es par erreur.
* **API nord-sud** : ouvertes vers l‚Äôext√©rieur.
* **API est-ouest** : utilis√©es en interne.


## **Qu‚Äôest-ce que la s√©curit√© des API ?**

* La s√©curit√© des API consiste √† **prot√©ger les interfaces de communication** entre applications contre les abus, fuites de donn√©es et attaques.
* Les API sont au c≈ìur des applis web, mobiles et IoT ‚Üí elles v√©hiculent souvent des donn√©es sensibles.
* Menaces principales : 
    * Attaques MITM, injections (SQL, XSS, LDAP): donn√©es mal valid√©es
    * DDoS : submersion de requ√™tes
    * Contr√¥le d‚Äôacc√®s bris√©.
    * Credential stuffing : r√©utilisation d‚Äôidentifiants vol√©s.
    * Data exfiltration : extraction de donn√©es sensibles via API publiques.
    * API Zombies : vieilles versions non d√©sactiv√©es.
* Importance croissante avec l‚Äôessor de l‚ÄôIoT et des microservices.


## Authentification vs Autorisation

* **Authentification** = prouver son identit√©.
  üîë Exemple : Se connecter avec un mot de passe ou un jeton JWT.
* **Autorisation** = d√©finir ce qu‚Äôon a le droit de faire.
  üîê Exemple : Un utilisateur ¬´ normal ¬ª peut consulter ses factures, mais seul un ¬´ admin ¬ª peut supprimer un compte.

**Analogie** :

* Authentification = montrer sa carte d‚Äôidentit√© √† l‚Äôentr√©e d‚Äôun b√¢timent.
* Autorisation = badge qui permet ou non d‚Äôentrer dans certaines salles.



## S√©curit√© des API REST vs SOAP

* **REST** : utilise HTTP, JSON, URI ‚Üí plus simple et l√©ger, mais vuln√©rable sans s√©curisation.
* **SOAP** : bas√© sur XML, signatures et jetons SAML ‚Üí plus lourd mais plus strict niveau s√©curit√©.
* Bonne pratique REST : HTTPS + jetons (JWT, OAuth).
* REST est aujourd‚Äôhui le standard, SOAP reste utilis√© dans les syst√®mes legacy.


## **S√©curit√© des API : approche syst√©matique**

* Strat√©gie compl√®te = inventaire de toutes les API (publi√©es, fant√¥mes, zombies).
* Classer les donn√©es manipul√©es : sensibles vs non sensibles.
* Mettre en place des m√©canismes pour :

  * D√©tection des API fant√¥mes (non document√©es).
  * Correction des vuln√©rabilit√©s (authentification cass√©e, autorisation faible).
  * Surveillance continue.

## 8. **S√©curit√© bas√©e sur les signatures vs analyse comportementale**

* **Signatures** : rapide, efficace contre attaques connues ‚Üí mais limit√©.
* **Analyse comportementale + IA/ML** : d√©tecte les anomalies (ex. un utilisateur qui fait 10 000 requ√™tes en 2 min).
* N√©cessaire pour les attaques nouvelles ou sans signature.

### **D√©tection et r√©ponse API (ADR)**

* Analyse de donn√©es historiques pour :

  * D√©finir un comportement ¬´ normal ¬ª.
  * D√©tecter les anomalies.
  * G√©n√©rer des alertes.
* Impl√©ment√©e via des solutions SaaS (scalabilit√© n√©cessaire).

## Normes et bonnes pratiques de s√©curit√©

1. **Chiffrement (TLS/SSL) : Toujours utiliser HTTPS (TLS)**
Prot√®ge donn√©es en transit.
   ```http
   http://api.monsite.com ‚ùå
   https://api.monsite.com ‚úÖ
   ```

   ‚ûù Emp√™che un attaquant d‚Äôintercepter les donn√©es (attaque MITM).

2. **Limiter le nombre de requ√™tes (Rate Limiting)**

   * Ex. : max 100 requ√™tes/minute par utilisateur.

   ```js
   const rateLimit = require("express-rate-limit");
   app.use(rateLimit({ windowMs: 60000, max: 100 }));
   ```

3. **Valider les entr√©es utilisateur (Input Validation)**
Vuln√©rabilit√©s courantes : injections SQL, JSON mal valid√©s, absence de limitation de d√©bit.
   ```js
   // Mauvais : concat√©nation de cha√Ænes -> vuln√©rable SQL Injection
   db.query(`SELECT * FROM users WHERE id = ${req.query.id}`);

   // Correct : requ√™tes param√©tr√©es
   db.query("SELECT * FROM users WHERE id = ?", [req.query.id]);
   ```

4. **Ne pas exposer trop de donn√©es (Excessive Data Exposure)**

   * Mauvais :

     ```json
     { "id":1, "name":"Alice", "password":"123456" }
     ```
   * Correct :

     ```json
     { "id":1, "name":"Alice" }
     ```

5. **Messages d‚Äôerreur g√©n√©riques**

   * Mauvais : `Erreur SQL: invalid column 'password'`
   * Correct : `Erreur : requ√™te invalide`

6. **Jetons** : valident l‚Äôidentit√© des requ√™tes et expiration des jetons

7. **OAuth / OpenID Connect** : standards modernes pour authN/authZ.

8. **Zero Trust** : aucun trafic n‚Äôest fiable par d√©faut ‚Üí tout doit √™tre authentifi√©.

9. S√©curiser les d√©pendances tierces.

10. Utiliser des en-t√™tes de s√©curit√©.

11. Contr√¥ler l‚Äôacc√®s (RBAC, ABAC).

12. Masquer les donn√©es sensibles (cartes bancaires).

13. Liste blanche d‚ÄôIP.

### **WAAP (Web Application and API Protection)**

* √âvolution des WAF (pare-feux applicatifs).
* Combine : WAF + Anti-bots + DDoS protection + API Security.
* Apporte :

  * Gestion centralis√©e des politiques.
  * Limitation de d√©bit.
  * Audit complet.


### **OWASP Top 10 API Security Risks ‚Äì 2023**

1. **Broken Object Level Authorization (BOLA)** : acc√®s non autoris√© √† un objet (ex. changer un `userId`).
2. **Broken Authentication** : auth mal impl√©ment√©e ‚Üí vol/forgery de tokens.
3. **Broken Object Property Level Authorization** : exposition de propri√©t√©s sensibles.
4. **Unrestricted Resource Consumption** : pas de limites ‚Üí DDoS.
5. **Broken Function Level Authorization** : acc√®s √† des fonctions admin non prot√©g√©es.
6. **Unrestricted Access to Sensitive Business Flows** : abus d‚Äôun processus m√©tier (ex. spam de r√©servations).
7. **SSRF** : envoi de requ√™tes non valid√©es par le serveur.
8. **Security Misconfiguration** : mauvaise configuration (TLS absent, CORS trop permissif).
9. **Improper Inventory Management** : API fant√¥mes/zombies.
10. **Unsafe Consumption of APIs** : trop de confiance dans les API tierces.



## M√©thodes d‚Äôauthentification dans les API

1. **Cl√©s API** (API Key)

   * Simple mais peu s√©curis√©e si partag√©e.

   ```http
   GET /users
   Authorization: Api-Key 12345
   ```

   ‚ûù Bien pour des services internes, pas pour des donn√©es sensibles.

2. **JWT (JSON Web Token)**

   * Jeton sign√©, contient les infos de l‚Äôutilisateur. Un utilisateur obtient un token JWT apr√®s login :

   ```json
    {
    "user": "alice",
    "role": "admin",
    "exp": "2025-09-15T12:00:00Z"
    }

   ```
    Toutes ses requ√™tes suivantes contiendront Authorization: Bearer <token>.

   ```js
   // Exemple Node.js avec Express
   const jwt = require("jsonwebtoken");

   app.post("/login", (req, res) => {
     const user = { id: 1, role: "admin" };
     const token = jwt.sign(user, "secretKey", { expiresIn: "1h" });
     res.json({ token });
   });

   app.get("/profile", (req, res) => {
     const token = req.headers["authorization"]?.split(" ")[1];
     if (!token) return res.sendStatus(401);
     jwt.verify(token, "secretKey", (err, user) => {
       if (err) return res.sendStatus(403);
       res.json({ message: `Bonjour ${user.role}` });
     });
   });
   ```

   ‚ûù Standard moderne, portable, expiration configurable.

3. **OAuth 2.0 + OpenID Connect**

   * Utilis√© par Google, Facebook, GitHub.
   * Permet √† un utilisateur de se connecter via un service tiers.
   * Exemple : **Se connecter avec Google** sur un site e-commerce.

4. **mTLS (Mutual TLS)**

   * Bas√© sur des certificats.
   * Tr√®s s√ªr, utilis√© dans les API bancaires.



## Exemple complet d‚ÄôAPI s√©curis√©e (Node.js/Express)

```js
const express = require("express");
const jwt = require("jsonwebtoken");
const rateLimit = require("express-rate-limit");

const app = express();
app.use(express.json());

// Limiter les requ√™tes
app.use(rateLimit({ windowMs: 60000, max: 50 }));

// Middleware d‚Äôauthentification
function authenticate(req, res, next) {
  const token = req.headers["authorization"]?.split(" ")[1];
  if (!token) return res.sendStatus(401);
  jwt.verify(token, "secretKey", (err, user) => {
    if (err) return res.sendStatus(403);
    req.user = user;
    next();
  });
}

// Login -> g√©n√®re un JWT
app.post("/login", (req, res) => {
  const user = { id: 1, role: "admin" };
  const token = jwt.sign(user, "secretKey", { expiresIn: "1h" });
  res.json({ token });
});

// Route prot√©g√©e
app.get("/data", authenticate, (req, res) => {
  res.json({ message: `Bienvenue ${req.user.role}`, data: [1,2,3] });
});

app.listen(3000, () => console.log("API s√©curis√©e sur http://localhost:3000"));
```


## S√©curit√© avanc√©e

* **Analyse comportementale (IA/ML)** :
  ‚ûù Exemple : un utilisateur qui consulte soudainement 10 000 comptes clients en 5 min = alerte.

* **D√©tection et r√©ponse API (ADR)** :
  ‚ûù Surveillance sur plusieurs semaines pour d√©tecter des sch√©mas anormaux.

* **Passerelles API (Kong, Apigee, AWS API Gateway)** :
  ‚ûù Gestion centralis√©e : authentification, quotas, logs.

* **WAAP (Web Application & API Protection)** :
  ‚ûù Combine WAF + anti-bots + API Security.


## √âtude de cas

### Cas 1 : API e-commerce sans s√©curit√©

* URL : `/api/orders?userId=2`
* Un attaquant change `2` en `3` et consulte les commandes d‚Äôun autre client.

### Cas 2 : API s√©curis√©e

* V√©rification d‚Äôauthentification + autorisation (RBAC).
* L‚ÄôAPI refuse l‚Äôacc√®s : `403 Forbidden`.


## √Ä savoir :

* **Les API publiques sont-elles plus vuln√©rables ?** ‚Üí pas forc√©ment, d√©pend des contr√¥les appliqu√©s.
* **MFA pour API ?** ‚Üí Oui, possible et recommand√©.
* **Comment savoir si une API est compromise ?** ‚Üí logs + d√©tection anomalies.
* **Fr√©quence des audits** ‚Üí au moins 1 fois/an + apr√®s toute mise √† jour importante.

## Conclusion

La **s√©curit√© des API** repose sur 4 piliers :

1. üîë Authentification forte (JWT, OAuth).
2. üîê Autorisation stricte (RBAC, ABAC).
3. üõ°Ô∏è D√©fenses techniques (TLS, rate limiting, input validation).
4. üìä Surveillance continue (logs, analyse comportementale, ADR).

üëâ **Sans s√©curit√©, les API sont des portes ouvertes aux attaquants.**




